<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<button id="sendBtn">JSON 수신</button>
<div id="message"></div>

<script>
    let button = document.querySelector("#sendBtn");
    button.addEventListener("click", showMessage);

    function requestJson() {
        let item = {
            productId: "bangry",
            name: "삼송TV",
            price: 1000
        };

        let option = {
            method: "post",
            headers: {
                "Content-Type": "application/x-www-form-urlencoded"
            },
            body: JSON.stringify(item)
        };

        return fetch("/json", option)
            .then((response) => {
                // throw new Error("테스트 오류 발생");
                return response.json();
            });
        // return fetch("/json", option);
    }

    async function showMessage() {
        try {
            const member = await requestJson();
            console.log(member);
            const div = document.querySelector("#message");
            div.innerHTML = `아이디: ${member.id}, 이름: ${member.name}`;
            // 동적 CSS 적용
            div.style.width = '200px';
            div.style.backgroundColor = 'yellow';
            div.style.color = '#ff0000';
            div.style.border = '2px dotted red';
        }catch (e) {
            console.log(e);
        }
    }

    function showErrorMessage(error) {
        const div = document.querySelector("#message");
        div.innerHTML = error;
        // 동적 CSS 적용
        div.style.width = '200px';
        div.style.backgroundColor = 'yellow';
        div.style.color = '#ff0000';
        div.style.border = '2px dotted red';
    }
</script>
</body>
</html>