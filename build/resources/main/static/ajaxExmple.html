<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
    <input type="text" name="message">
    <button id="sendBtn">메시지 전송</button>
    <div id="message"></div>


<script>
    // 자바스크립트를 이용한 서버와의 비동기 통신
    // let button = document.getElementById("sendBtn");
    let button = document.querySelector("#sendBtn");
    button.addEventListener("click", event =>{
        ajaxRequest();
    });

    function ajaxRequest(){
        const input = document.querySelector("[type='text']");
        // const input = document.querySelector("input");
        const message = input.value;

        let request = new XMLHttpRequest();
        request.open("get", `/message?message=${message}`);
        request.addEventListener("readystatechange", event => {
            if(request.readyState === 4){
                if(request.status === 200){
                    //alert(request.responseText);
                    // 현재 페이지의 특정 영역에 출력
                    // document.querySelector("#message").innerHTML = request.responseText;
                    showMessage(request.responseText);
                }else if(request.status === 400){
                    showMessage("잘못된 요청입니다..");
                }else if(request.status === 404){
                    showMessage("페이지를 찾을 수 없습니다...");
                }
            }else{
                console.log("데이터 수신중.....");
            }
        });
        request.send();
    }

    function showMessage(message){
        const div = document.querySelector("#message");
        div.innerHTML = message;
        // 동적 CSS 적용
        div.style.width = '200px';
        div.style.backgroundColor = 'yellow';
        div.style.color = '#ff0000';
        div.style.border = '2px dotted red';
    }
</script>
</body>
</html>